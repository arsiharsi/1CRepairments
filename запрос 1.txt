ВЫБРАТЬ
	ЦеныНаЗапчасти.Запчасть КАК Запчасть,
	ЦеныНаЗапчасти.ВремяИзменения КАК ВремяИзменения,
	ЦеныНаЗапчасти.Цена КАК Цена
ИЗ
	РегистрСведений.ЦеныНаЗапчасти КАК ЦеныНаЗапчасти
{ГДЕ
	ЦеныНаЗапчасти.ВремяИзменения >= &ДатаНачалаПериода
	И ЦеныНаЗапчасти.ВремяИзменения <= &ДатаКонцаПериода
	ИЛИ НЕ &ИспользоватьПериод}
ОБЪЕДИНИТЬ
ВЫБРАТЬ
    ЦеныНаЗапчасти.Запчасть КАК Запчасть,
    МАКСИМУМ(ЦеныНаЗапчасти.ВремяИзменения) КАК ПоследнееВремяИзменения,
    МАКСИМУМ(НьюЦеныНаЗапчасти.Цена) КАК ПоследняяЦена     
ИЗ
    РегистрСведений.ЦеныНаЗапчасти КАК ЦеныНаЗапчасти
    ПОЛНОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНаЗапчасти КАК НьюЦеныНаЗапчасти
    	ПО НьюЦеныНаЗапчасти.Запчасть = ЦеныНаЗапчасти.Запчасть
ГДЕ
    ЦеныНаЗапчасти.ВремяИзменения < &ДатаНачалаПериода
	ИЛИ НЕ &ИспользоватьПериод
СГРУППИРОВАТЬ ПО 
	ЦеныНаЗапчасти.Запчасть
УПОРЯДОЧИТЬ ПО ЦеныНаЗапчасти.ВремяИзменения УБЫВ
